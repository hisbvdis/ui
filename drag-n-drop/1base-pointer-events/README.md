# **Drag-n-Drop: базовый пример (с помощью Pointer Events)**

## Этап 1 - подготовка к перемещению
**1. Обработчик**
- Добавить обработчик, который будет отслеживать событие нажатия указателя на Drago (`pointerdown`) и запускать функцию с действиями по подготовке
- `evt.preventDefault()` - для предотвращения выделения содержимого при нажатом указателе

**2. Границы перемещения**
- Если задан элемент-области перемещения, можно вычислить допустимые границы (с учётом размеров Drago)
- Система координат и документа и элемента Drago начинается с левого верхнего угла, и увеличивается вправо и вниз, поэтому границы рассчитываются следующим образом:
  - `Левая граница` – координата левой стороны области (так как начало Drago будет совпадать с началом области перемещения)
  - `Верхняя граница` – координата верхней стороны области (так как начало Drago будет совпадать с началом области перемещения)
  - `Правая граница` – координата правой стороны области перемещения "минус" ширина Drago
  - `Нижняя граница` – координата нижней стороны области перемещения "минус" высота Drago

**3. Место клика внутри Drago**
- Чтобы при перемещении мыши Drago сохранял положение относительно курсора, нужно вычислить координаты клика на Drago относительно его левого верхнего угла
- `Ось X` – из координаты X клика вычесть координату левого края Drago
- `Ось Y` – из координаты Y клика вычесть координату верхнего края Drago

**4. Подготовить Drago**
- Задать абсолютное позиционирование: `position: absolute`
- Поднять Drago выше всего остального: `z-index: 100`
  - Не обязательно
- Переместить Drago в body, чтобы среди предков не было: `position: relative` 
  - Не обязательно. Может быть полезно, если область перемещения не ограничена


## Этап 2 - перемещение
**1. Обработчики**
- Добавить обработчик для события "dragstart", который будет возвращать `return false;`, чтобы предотвратить перехват браузером Drag-n-Drop события
- Добавить обработчик, который будет отслеживать события перемещения указателя (`pointermove`) и запускать функцию перемещения Drago

**2. Общая функция перемещения**
- Для удобства, функция объединяющая две другие функции:
  - расчёт координат, в которые нужно переместить Drago
  - перемещение Drago в указанные координаты

**3. Рассчитать координаты назначения**
- Рассчитать координаты, в которые нужно переместить Drago
- Чтобы сохранялась позиция под курсором: для каждой оси из координаты клика "относительно документа" вычитать координату клика "относительно Drago"
- Чтобы не выходить за границы области перемещения: полученные на предыдущем шаге координаты сравнить с координатами границ "с учётом размера Drago"
  - если превышают, возвращать координаты границ "с учётом размера Drago"
  - если не превышают, возвращать координату с предыдущего шага (с сохранением позиции относительно курсора)

**4. Переместить Drago**
- Переместить Drago в указанные координаты курсора


## Этап 3 - завершение перемещения
**1. Обработчики**
- Удалить ранее созданные обработчики

**2. Глобальные переменные**
- Обнулить глобальные переменные, чтобы не было конфликтов


## Источники (литература)
- [JS.ru – Drag'n'Drop через события мыши](https://learn.javascript.ru/mouse-drag-and-drop)