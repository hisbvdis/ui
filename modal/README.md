# **Модальные окна**

## Кнопка, открывающая окно
**Тег `<a>`**
- Кнопка, открывающая  модальное окно - это ссылка `<a>`
- В "href" адрес страницы с таким же функционалом (на случай, если JS не сработает или нажмут средней кнопкой мыши)

**Атрибут `data-modal`**
- Отражает назначение кнопки - открывать модальные окна
- Содержит уникальный ID модального окна, которое нужно открыть
- Пример: `data-modal="login"`

**Атрибут `aria-haspopup`**
- Отражает то, что кнопка вызывает всплывающее окно (popup)
- У атрибута могут быть и другие значения, но здесь используется "dialog"
- Пример: `aria-haspopup="dialog"`


## Модальное окно
### HTML
**Тег `dialog`**
- В будущем использовать `<dialog>`, а пока плохая поддержка – `<section>`
- Пример: `<dialog>, <section>`

**Атрибут `id`**
- Содержит уникальный идентификатор данного модального окна
- Пример: `<dialog id="modal1">`

**Атрибут `aria-modal`(????)**
- Сообщает вспомогательным технологиям, что окна под текущим диалоговым окном недоступны для взаимодействия (инертны)
- Пример: `aria-modal="true"`

**Атрибут `role`**
- Сообщает скринридерам, что элемент является диалоговым окном
- Пример: `role="dialog"`

**Атрибут `aria-labelledby`**
- Указывает ID элемента, содержащего заголовок (задавая диалоговому окну доступное имя)
- В значении должен содержать ID элемента-заголовка (h2-h6)
- Пример: `aria-labelledby="modal1__title"`

**Атрибут `aria-describedby`**
- Указывает ID элемента, содержащего описание (задавая диалоговому окну доступное описание)
- В значении должен быть ID элемента с описанием
- Пример: `aria-describedby="modal1__desc"`


### CSS
**Скрытие/показ окна**
- Скрытие окна через `display: none` не позволяет использовать переходы (анимации)
- Скрыть окно:
  1. Убрать из Accessibility-дерева (скрыть от скринридеров): атрибуту `aria-hidden` задать значение `true`
  2. Исключить из навигации с клавиатуры: атрибуту `tabindex` задать значение `-1`
  3. Скрыть визуально: добавить класс `.srOnly`
- Показать окно:
  1. Вернуть в Accessibility-дерево (показать скринридерам): атрибуту `aria-hidden` задать значение `false`
  2. Вернуть в навигацию с клавиатуры: атрибуту `tabindex` задать значение `0`
  3. Отобразить визуально: удалить класс `.srOnly`


## Подложка окна
- Scrim - подложка, которая ловит клики
- создаётся автоматически через JS в виде отдельного элемента в конце `<body>`


## Кнопки внутри окна:
- **`data-close-btn`** – просто закрывает окно
  - примеры: "Закрыть", "Отмена"
  - таких кнопок может быть любое количество кнопок
- **`data-enter-btn`** – нажимается по кнопке "Enter"
  - примеры: "Ok"
  - кнопка с таким атрибутом в модальном окне может быть только одна
  - если нужно просто закрывать окно по "Enter", то должна содержать ещё и атрибут кнопки закрытия – `data-close-btn`
- **`data-ctrl-enter-btn`** – нажимается по кнопке "Enter"
  - примеры: "Отправить на модерацию"
  - кнопка с таким атрибутом в модальном окне может быть только одна


## **TODO**
- Когда нажимается Enter при фокусе на кнопке "Закрыть", событие нажатия на "enter-btn" не должно срабатывать
- Последовательное открытие нескольких модальных окон
  - Удобно сделать фон в виде отдельного элемента в конце body
- При открытом модальном окне фокус должен переходить между элементами только в пределах этого окна
- Фокус при открытии
  - Фокус на само окно или на первое его поле
  - Пока окно открыто, фокус не должен выходить за границы окна
- Фокус при закрытии
  - Фокус на элемент, который открыл окно
- Режим открытия модального окна, при котором клик по фону не закрывает окно (например, когда нужно ввести какие-то данные)


## **Источники (статьи)**
- Делаем модальные окна для сайта. Заботимся об удобстве и доступности ([ссылка](https://habr.com/ru/post/519662/))
- Вы не знаете как должны работать модальные окна ([ссылка](https://habr.com/ru/post/521422/))
- Видео - Знакомьтесь, модальное окно, Анна Селезнёва ([ссылка](https://youtu.be/s6PI8pKQxgo))