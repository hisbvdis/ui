# Модальные окна

## Триггер: Разметка
**Тег**
- `button` — для открытия модальных окон, не имеющих отдельных страниц (например, если окно предназначено для получения подтверждения о действии)
- `a` — для открытия модальных окно, имеющих отдельную запасную страницу. Её адрес указывается в атрибуте "href" (на случай, если JS не сработает или будет нажатие средней кнопкой мыши)

**Целевое окно**
- Атрибут "data-modal"
- Содержит ID элемента модального окна, которое нужно открыть
- Пример: `data-modal="m1"`

**Ручная обработка клика**
- Атрибут "data-manual-open"
- Отключает автоматическое открытие модального окна, позволяя написать свой обработчик клика
- Пример: `data-manual-open="true"`

**Триггер всплывающего окна**
- Атрибут "aria-haspopup"
- Сообщает скринридерам, что кнопка вызывает всплывающее окно
- У атрибута могут и быть другие значения, но для модальных окон нужно указывать `dialog`
- Для тега `<a>` указывать не нужно (источник — валидатор "create-react-app")
- Пример: `aria-haspopup="dialog"`


## Модальное окно: Разметка
**Тег**
- Использовать тег `<dialog>` (раньше был `<section>`)
- Он семантически предназначен для модальных или других диалоговых окон

**Размещение в документе**
- Элемент окна размещать в конце документа перед закрывающим тегом `</body>`

**Уникальный ID**
- Атрибут "id"
- Содержит уникальный идентификатор, по которому может быть найдено
- Пример: `id="modal1"`

**Доступная роль**
- Атрибут "role"
- Сообщает скринридерам, что элемент является диалоговым окном
- Пример: `role="dialog"`

**Доступный тип**
- Атрибут "aria-modal"
- Сообщает скринридерам, что при открытии диалогового окна, элементы под ним не должны быть доступны для взаимодействия
- Пример: `aria-modal="true"`

**Фокус с клавиатуры**
- Атрибут "tabindex"
- Управляет возможностью поставить фокус на окно с клавиатуры
- В скрытом состоянии должно иметь значение "-1", при открытии окна "0"
- Нельзя использовать с тегом `<dialog>` (источник — MDN)[https://developer.mozilla.org/en-US/docs/Web/HTML/Element/dialog]
- Пример: `tabindex="-1"`, `tabindex="0"`

**Доступный заголовок**
- Атрибут "aria-labelledby"
- Содержит ID дочернего элемента, выступающего заголовком модального окна
- При открытии модального окна, скринридер озвучивает его заголовок
- Пример: `aria-labelledby="modal1__title"`

**Доступное описание**
- Атрибут "aria-describedby"
- Содержит ID дочернего элемента, выступающего текстовым содержимым модального окна
- Если текстовых элементов много, следует обернуть их в один общий родитель и указать его ID
- При открытии модального окна, скринридер озвучивает его описание
- Атрибут следует задавать только в том случае, если у модального окна есть статический текст
- Пример: `aria-describedby="modal1__desc"`


## Модальное окно: Стилизация
**Скрытое окно**
1. Скрыть визуально:
  - Стандартные стили должны соответствовать классу `.srOnly`
2. Убрать из дерева доступности (скрыть от скринридеров):
  - Атрибуту `aria-hidden` задать значение `true`
3. Исключить из навигации с клавиатуры:
  - Атрибуту `tabindex` задать значение `-1`
4. Скрыть в браузере (чтобы текстовое содержимое не находилось через поиск браузера):
  - CSS-свойству `visibility` задать значение `hidden`

**Открытое окно**
1. Отобразить визуально:
  - Сбросить значения свойств класса `.srOnly`
2. Вернуть в дерево доступности (показать скринридерам):
  - Атрибуту `aria-hidden` задать значение `false`
3. Вернуть в навигацию с клавиатуры:
  - Атрибуту `tabindex` задать значение `0`
4. Отобразить в браузере (чтобы текстовое содержимое находилось через поиск браузера):
  - CSS-свойству `visibility` задать значение `visible`


## Модальное окно: Логика поведения
**Фокус при открытии**
- При открытии окна, фокус ставится на первый интерактивный элемент
- Если есть кнопка с атрибутом `data-focus`, поставить фокус на неё

**Удержание фокуса в окне**
- Фокус на элементах окна зациклен
- При нажатии "Tab" на последнем элементе, переводить фокус на первый
- При нажатии "Shift+Tab" на первом элементе, переводить фокус на последний

**Фокус при закрытии окна**
- При закрытии окна фокус должен быть помещён на триггер, вызвавший модальное окно


## Backdrop (подложка)
**Элемент**
- Подложкой может выступать сам элемент модального окна или отдельный элемент в конце `<body>` (его можно создавать автоматически через JS)


## Кнопки внутри окна
**Кнопка "Закрыть"**
- Нажатие приводит к закрытию окна
- Таких кнопок может быть любое количество
- Обозначается атрибутом `data-close-btn`
- Пример: кнопка "Отмена" или "X"

**Кнопка с фокусом**
- Получает фокус при открытии окна, что позволяет сразу активировать её нажатием "Enter"
- Может быть только одна на всё окно
- Обозначается атрибутом `data-focus`
- Пример: кнопка "Ок"

**Кнопка для "Ctrl+Enter"**
- Активируется нажатием "Ctrl+Enter" на клавиатуре
- Уместно использовать, когда в окне есть другие интерактивные элементы
- Может быть только одна на всё окно
- Обозначается атрибутом `data-ctrl-enter-btn`
- Пример: кнопка "Отправить на модерацию", кнопка "Опубликовать"