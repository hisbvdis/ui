# **Модальные окна**

## Кнопка, открывающая окно
**Тег `<button> и <a>`**
- Если модальное окно не содержит большого количества информации (например, предназначено для получения подтверждения о действии), следует использовать элемент `<button>`
- Если же окно содержит важную информацию (например, форма авторизации на сайте), следует использовать элемент `<a>`, а в атрибуте "href" указывать адрес запасной страницы с таким же функционалом (на случай, если JS не сработает или нажмут средней кнопкой мыши)

**Атрибут `data-modal`**
- Содержит уникальный ID модального окна, которое нужно открыть
- Пример: `data-modal="login"`

**Атрибут `aria-haspopup`**
- Отражает то, что кнопка вызывает всплывающее окно (popup)
- У атрибута могут быть и другие значения, но здесь нужно указывать "dialog"
- Пример: `aria-haspopup="dialog"`


## Модальное окно
### Разметка
**Тег `section`**
- Содержимое окна следует помещать в тег `<section>` в конце документа перед закрывающим `</body>`
- В будущем, возможно, можно будет использовать `<dialog>`, если улучшится поддержка

**Атрибут `id`**
- Содержит уникальный идентификатор данного модального окна
- Пример: `<dialog id="modal1">`

**Атрибут `aria-modal`**
- Сообщает вспомогательным технологиям, что элементы под текущим диалоговым окном недоступны для взаимодействия (инертны)
- Пример: `aria-modal="true"`

**Атрибут `role`**
- Сообщает скринридерам, что элемент является диалоговым окном
- Пример: `role="dialog"`

**Атрибут `aria-labelledby`**
- Содержит ID элемента, выступающего заголовком модального окна
- При открытии модального окна, скринридер озвучит его заголовок
- Пример: `aria-labelledby="modal1__title"`

**Атрибут `aria-describedby`**
- Содержит ID элемента, выступающего текстовым описанием модального окна. Если текстовых элементов много, следует обернуть их в общий элемент и указать его ID
- При открытии модального окна, скринридер озвучит его описание
- Пример: `aria-describedby="modal1__desc"`


### Стилизация
**Скрытие/показ окна**
- Скрытие окна через `display: none` не позволяет использовать переходы (анимации)
- Для скрытия окна:
  1. Убрать из Accessibility-дерева (скрыть от скринридеров): атрибуту `aria-hidden` задать значение `true`
  2. Исключить из навигации с клавиатуры: атрибуту `tabindex` задать значение `-1`
  3. Скрыть визуально: добавить класс `.srOnly`
- Для отображения окна:
  1. Вернуть в Accessibility-дерево (показать скринридерам): атрибуту `aria-hidden` задать значение `false`
  2. Вернуть в навигацию с клавиатуры: атрибуту `tabindex` задать значение `0`
  3. Отобразить визуально: удалить класс `.srOnly`


### Логика поведения
**Фокус при открытии**
- При открытии окна, фокус должен быть перемещён на первый интерактивный элемент
- Если интерактивных элементов нет (окно подтверждения действия), удобно поместить фокус на кнопку подтверждения, чтобы она сразу нажималась по "Enter"


## Подложка окна
**Элемент**
- Подложкой может выступать сам элемент модального окна или отдельный элемент в конце `<body>` (его можно создавать автоматически через JS)


## Кнопки внутри окна:
**Кнопка "Закрыть"**
- Просто закрывает окно
- Таких кнопок может быть любое количество
- Обозначается атрибутом "data-close"
- Пример: Отмена

**Кнопка с фокусом (для "Enter")**
- Получает фокус при открытии окна, что позволяет сразу активировать её нажатием "Enter"
- Обозначается атрибутом "data-focus"
- Пример: Ок

**Кнопка для "Ctrl+Enter"**
- Активируется нажатием "Ctrl+Enter" на клавиатуре
- Уместно использовать, когда в окне есть другие интерактивные элементы
- В окне может быть одна такая кнопка
- Обозначается атрибутом "data-ctrl-enter"
- Пример: Отправить на модерацию, Опубликовать


## TODO
- Когда нажимается Enter при фокусе на кнопке "Закрыть", событие нажатия на "enter-btn" не должно срабатывать
- Последовательное открытие нескольких модальных окон
  - Удобно сделать фон в виде отдельного элемента в конце body
- При открытом модальном окне фокус должен переходить между элементами только в пределах этого окна
- Фокус при открытии
  - Фокус на само окно или на первое его поле
  - Пока окно открыто, фокус не должен выходить за границы окна
- Фокус при закрытии
  - Фокус на элемент, который открыл окно (для этого передавать в обработчик элемент, открывший окно)
- Режим открытия модального окна, при котором клик по фону не закрывает окно (например, когда нужно ввести какие-то данные)
- Модуль с измерением ширины скроллбара и созданием переменной, на которую будет смещаться правый отступ у "body"


## Источники (статьи)
- Делаем модальные окна для сайта. Заботимся об удобстве и доступности ([ссылка](https://habr.com/ru/post/519662/))
- Вы не знаете как должны работать модальные окна ([ссылка](https://habr.com/ru/post/521422/))
- Видео - Знакомьтесь, модальное окно, Анна Селезнёва ([ссылка](https://youtu.be/s6PI8pKQxgo))